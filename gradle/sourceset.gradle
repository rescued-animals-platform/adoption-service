sourceSets {
    main {
        resources {
            srcDirs = ['migrations/','src/main/resources']
        }
    }
    integrationTest {
        java {
            srcDir 'src/integration/java'
            compileClasspath += main.output + test.output
            runtimeClasspath += main.output + test.output
        }
        resources {
            srcDir 'src/integration/resources'
        }
    }
}

task integrationTest(type: Test) {
    setTestClassesDirs(sourceSets.integrationTest.output)
    classpath = sourceSets.integrationTest.runtimeClasspath
    testLogging {
        exceptionFormat "full"
        events "passed", "failed", "skipped"
    }
    systemProperty 'spring.profiles.active', 'test'
}